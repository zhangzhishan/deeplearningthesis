\chapter{基于深度学习的天波超视距雷达地海杂波识别}
\section{引言}
% TODO: 按照英文文章重新布局
% \textcolor{red}{该章可以添加利用二维卷积神经网络进行识别的算法实验}
% \textcolor{red}{复合类的提取}

% \textcolor{red}{该部分仍然存在问题}

天波超视距雷达目标定位精度依赖于传播模式的准确识别以及PD变换系数的精确测量。电离层传播的复杂性使得传播模式很难精确确定，而电离层探测子系统独立于主雷达工作导致其提供的坐标配准参数与主雷达量测回波存在不一致性、误差大等问题，从而造成电离层传播模式识别正确率低、目标定位精度差等。天波超视距雷达地海杂波识别是一种基于无源信标（远海区域的岛屿等陆地）获得PD变换系数的技术。鉴于远海地区有源设备的布置面临着较大的困难，通过区分识别地海杂波、构建地海边界轮廓、与先验地理轮廓信息匹配可同样提供坐标配准修正参数，改善周围航迹目标的定位精度。受分辨率低、定位精度差、系统偏差大、电离层多模、多路径传播等因素影响，天波雷达地海杂波识别技术存在很大挑战，主要体现在以下几个方面:
\begin{itemize}
	\item 天波雷达的距离分辨率为7.5-30公里，方位分辨率为0.582-1.067°，低分辨率影响地海特性的判别以及匹配精度；
	\item 电离层状况变化情况十分复杂，导致地海杂波的特性并不稳定，区分地海杂波特性的布拉格峰会发生偏移甚至某个峰会消失，对地海杂波的建模影响很大；
	\item 确定修正系数对周围区域航迹的修正范围、有效性等难度大，需要大量实装数据验证；
\end{itemize}

本章提供了一种新的在复杂的电离层环境下的基于深度神经网络的地海杂波识别技术，避免了手工提取地海杂波特征。构建了适用于天波超视距雷达地海杂波类型识别的卷积神经网络，利用大量训练数据对卷积神经网络进行训练，提取合理的特征；然后，利用提取的特征对实时雷达地海杂波回波进行在线分类识别。我们利用不同电离层条件、雷达工作条件、位置和时间下的频谱数据对我们所提出的算法进行了验证，实验结果证明我们的算法大大提高了天波超视距雷达地海杂波的识别正确率与实时性。

本章安排如下： 3.2节对天波超视距雷达地海杂波信号进行了分析，并对数据集进行分组，3.3节构建了本章的基于深度学习的分类器，详细阐述了根据实际数据的特性构建分类器的过程，3.4节利用实际数据对于本章的分类器与已有方法进行对比，验证了本章提出方法的性能，3.5节进行本章总结。

\section{地海杂波频谱数据分析}
对于一般的进行天波雷达地海杂波识别的文章，其主要利用海杂波的Bragg特性，但是在实际情况中，受电离层条件、工作环境等的影响，会出现很多频谱很难分辨的情形，如图\ref{fig:spectrum}所示。
\begin{figure}[H]
	\centering
	\subfloat[地杂波频谱]{\includegraphics[width=0.4\textwidth]{figures/othr/land}%
		\label{fig:land}}
	\hfil
	\subfloat[海杂波频谱]{\includegraphics[width=0.4\textwidth]{figures/othr/sea}%
		\label{fig:sea}}
	\caption{两幅无法轻易区分的地海杂的频谱波示意图。图 \ref{fig:land} 的布拉格峰具有小的频偏，图 \ref{fig:sea} 作为海杂波却无法容易的分辨出布拉格峰.}
	\label{fig:spectrum}
\end{figure}
在天波超视距雷达的工作过程中，不同的时间和地理位置对应于不同的电离层条件，不同的电离层条件将严重影响频谱的状态。对于不同的雷达工作条件，由于发射频率变化，回波频谱密度和幅度也将随之变化。通过观察、学习大量不同条件的频谱数据，可以更全面地区分地海杂波。

在本章的问题中，我们选取了几种不同的雷达工作配置（工作频率、朝向等）下的数据。多普勒频率的范围可以是-5Hz至5Hz，也可以是-20Hz至20Hz。我们分别以不同的频率训练数据。此外，对于相同频率的数据，我们通过人工辨识的方法从中抽取出可以准确判定为地或者海的样本数据用于实验的训练和测试。同时，为了保证样本的多样性，对于同一个雷达参数下的数据，我们根据季节、地理位置、一天的早中午进行了选择，确保可以覆盖尽可能多的情形。

我们所有的数据都来自不同时间，不同地点和不同雷达配置的频谱数据。我们分析了所有频谱数据，并选择一些典型的频谱数据，如图\ref{fig:classical_spectrum}所示。

\begin{figure}[H]
	\centering
	\subfloat[杂波干扰严重的频谱图]{\includegraphics[width=0.4\textwidth]{figures/othr/noise}}%
	\hfil
	\subfloat[具有较强展宽的频谱图]{\includegraphics[width=0.4\textwidth]{figures/othr/wide}}%

	\subfloat[Bragg峰缺失频谱图]{\includegraphics[width=0.4\textwidth]{figures/othr/lost}}
	\hfil
	\subfloat[Bragg峰偏移频谱图]{\includegraphics[width=0.4\textwidth]{figures/othr/shift}}

	\subfloat[对空工作模式频谱图]{\includegraphics[width=0.4\textwidth]{figures/othr/sky}}
	\hfil
	\subfloat[对海工作模式频谱图]{\includegraphics[width=0.4\textwidth]{figures/othr/tosea}}
	\caption{复杂环境下频谱图}
	\label{fig:classical_spectrum}	
\end{figure}


\subsection{数据集分组}
在本章的问题中，当雷达配置发生变化时，我们会获得不同的频率范围和精度频谱数据。例如，一些频谱数据的频率变化范围为-5Hz到5Hz、具有512个相干积累点，而另一些数据的频率变化范围为-10Hz到10Hz、相干积累点数为256个。因此，基于这两个条件，我们将所有数据分为4组：
\begin{itemize}
	\item 组 A: 如图\ref{fig:case128}所示，具有128个相干积累点数，频率变化范围为-5Hz到5Hz;
	\item 组 B: 如图\ref{fig:case256}所示，具有256个相干积累点数，频率变化范围为-5Hz到5Hz;
	\item 组 C: 如图\ref{fig:case512}所示，具有512个相干积累点数，频率变化范围为-5Hz到5Hz;
	\item 组 D: 如图\ref{fig:case1024}所示，具有1024个相干积累点数，频率变化范围为-5Hz到5Hz;
\end{itemize}
我们只选择了上述四个具有典型意义的分组的数据来进行验证，舍弃了其余类型的与他们相似的数据，例如频率变化范围为-10Hz到10Hz的具有512个相干积累点的数据，这与组B的数据基本相同。
\begin{figure}[H]
	\centering
	\subfloat[组 A]{\includegraphics[width=0.4\textwidth]{figures/othr/group128}%
		\label{fig:case128}}
	\hfil
	\subfloat[组 B]{\includegraphics[width=0.4\textwidth]{figures/othr/group256}%
		\label{fig:case256}}

	\subfloat[组 C]{\includegraphics[width=0.4\textwidth]{figures/othr/group512}%
		\label{fig:case512}}
	\hfil
	\subfloat[组 D]{\includegraphics[width=0.4\textwidth]{figures/othr/group1024}%
		\label{fig:case1024}}
	\caption{不同组数据的频谱对比示意图}
	\label{fig:group}
\end{figure}

\section{地海杂波识别算法}
天波超视距雷达目标的坐标配准问题在很大程度上影响了其跟踪精度，特别是对于电离层参数无法准确及时获得的较远。识别地海分界线主要有两个优点：第一个是我们可以使用获取的杂波地形图与实际的地图进行匹配，然后根据匹配结果计算偏移量，得到坐标修正系数，用来提高目标跟踪精度；另一方面，我们可以利用由识别结果获得的频谱上的偏移来校正频谱本身，以提高目标检测概率和准确度。

\textcolor{blue}{天波超视距雷达频谱数据的地海杂波识别有两个独特的挑战。第一个是难以对杂波进行建模，由于电离层模型变化较大导致杂波模型混乱且复杂性较高。传统的建模方法一般根据实际数据选取一种分布来描述雷达杂波，如瑞利分布（Rayleigh distribution），威布尔分布（Weibull distribution），K分布（K distribution）等。但天波超视距雷达获得的杂波模型一直变化，这种建模方法不能得到很好的结果。其次，传统的地海杂波的分类特征很难定量描述。一个熟练的操作人员可能很熟练地区分出地海杂波，但是这部分却很难利用数学模型对其描述。本章我们提出了一种新的可以有效解决上述挑战的利用深度卷积神经网络的方法。我们的算法将CNN应用于地海杂波识别。我们避免了对杂波进行建模选取特征的方法，从根本上避免了传统方法所面临的困难。}

天波超视距雷达地海杂波识别技术的处理流程可分为信息预处理、地海杂波识别两个处理层，如图\ref{fig:system}所示。具体过程为：对频谱数据进行清洗、裁剪、融合等预处理操作，将预处理过的整体频谱数据输入到已经训练好的深度卷积神经网络分类器中进行识别。\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{figures/othr/system}
	\caption{系统结构图}
	\label{fig:system}
\end{figure}

\subsection{数据预处理}
% 在本节中，我们首先介绍我们的算法的输入和输出变量。
% \subsection{特征向量和识别结果}
传统的分类问题一般利用各种不同的由原始数据进行变换得到的特征进行分类。在这里，我们利用原始的杂波频谱数据来做地海杂波的识别。同时针对于我们问题的数据形式，对输入数据做了二次处理。
我们并没有选择某距离方位角单元的完整杂波频谱数据作为输入特征，而是考虑到用来区分地海杂波属性的特征主要集中于零频附近，因此我们对原始频谱数据做了剪切处理，只选择了零频附近一个区域的数据。通过减少大量无用数据，我们在一定程度上减少了计算量而且有助于防止过拟合现象的出现。

另一方面，我们最初从雷达得到的数据为时域数据，我们对这些数据进行快速傅立叶变换获得频域中的数据。虽然，表面上看利用频域或者时域数据进行训练和测试区别不大。然而，在实际的情况中，特征所处的位置在时域数据以及频域数据中并不相同，并且频域数据的特征更加集中，这样在执行卷积运算时学习得到的特征也更加准确。

fft变换结构图

频谱数据预处理频谱数据是从天波超视距雷达获取的多普勒频率与幅度值对应的数据。在利用数据之前，我们首先对该数据进行清洗，把图\ref{fig:delete}这种并非处于正常探测模式下的数据进行去除。 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/delete}
	\caption{需要被清洗掉的数据}
	\label{fig:delete}
\end{figure}

由于数据来自不同波位、不同时刻，具有不同的雷达工作频率，我们在利用这些数据进行训练或者识别前需要首先对其进行基本的处理。主要包括将数据按照积累点数、波位和多普勒频率范围进行分类，不同类别的数据分开处理。另一方面，由于地海杂波特征主要集中于多普勒频率较低的区域，我们可以将数据进行裁剪，只选取有效数据(本章中在权衡信息保留以及计算量的清洗下，保留了处于零频附近，且频率范围为$[-5\text{Hz},+5\text{Hz}]$的区域)，在一定程度上减小计算量。 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.5\textwidth]{figures/othr/cut}
	\caption{数据裁剪示意图}
	\label{fig:cut}
\end{figure}

受电离层非平稳、时变等特性影响，天波超视距雷达杂波数据可能会出现较大波动。对这种波动不加处理会导致地海杂波识别结果不准确。在一个相对短时间内，电离层会保持一个较平稳的状态，也即同一距离方位单元的真实的地海属性不会发生变化。因此，本章采用滑窗融合的方法对输入数据进行预处理。其基本思想是将连续窗长时间$N$ 内的相邻杂波数据$x_1,x_2,\dots,x_N$ 进行加权融合得到新的频谱数据作为深度卷积神经网络分类器的输入
\begin{equation}
	x=\sum_{i=1}^N w_ix_i
	\label{equ:window_fusion}
\end{equation}
其中$w_i$ 为频谱数据$x_i$ 的权重，关于窗长及权重的选择会在后面仿真验证小节进行详细的讨论。从图\ref{fig:spectrum_fusion}可以看出，融合后的毛刺明显变少，更利于最终的分类识别。

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{figures/spectrum_fusion}
	\caption{数据融合示意图}
	\label{fig:spectrum_fusion}
\end{figure}

\subsection{分类算法设计}
深度学习体系结构中有几大网络模型，其中的卷积神经网络可以直接将整个需要分类的数据作为网络的输入，避免了传统识别算法中复杂的特征提取和数据重建过程。基于此优点，使卷积神经网络在本章所需解决的天波超视距雷达地海杂波特征识别问题中有着巨大优势。
典型的卷积神经网络由深层结构堆叠在一起的多个不同的层组成：输入层，多组卷积和池化层，有限数量的完全连接的隐藏层，以及输出层。其中最主要的部分为卷积层，其利用输入数据中的局部结构，将整个输入空间划分成很小的隐藏单元。将各个隐藏单元的权重构建得到的卷积核作用于整个输入空间，从而得到特征向量。利用这种机制，我们不仅大大减少了参数数量同时提高了数据的平移不变性。

天波超视距雷达地海杂波识别技术利用深度学习中的深度卷积神经网络算法（DCNN），避免了对于地海杂波的建模，也即从根本上避免了传统方法所面对的困难。如图 \ref{fig:othr_tech} 所示，其主要可分为训练和识别两个步骤：利用大量已打好标签的样本通过深度卷积神经网络进行训练；然后对于新得到的雷达频谱数据利用模型进行识别，获得当前频谱数据的识别结果。

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{figures/othr_tech}
	\caption{地海杂波识别技术结构图}
	\label{fig:othr_tech}
\end{figure}

利用深度卷积神经网络进行天波超视距雷达地海杂波识别过程的主要挑战与难点在于网络模型的设计。如图\ref{fig:fullconnect}所示，本章设计的深度卷积神经网络的结构在功能上可以分为特征提取和全连接网络这两部分，特征提取层主要通过卷积操作和池化操作从输入的频谱数据中学习出最好的卷积核以及这些卷积核的组合方式，同时每一层的输出又作为下一层的输入，每层具有多个特征向量，每个特征向量具有多个神经元，并且每个特征向量来自于一种卷积核所提取输入的一种特征；全连接网络，主要是将任何一个神经元均和上一层的任何神经元之间建立管理，通过矩阵运算得到输出结果。
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{figures/othr/fullconnect}
	\caption{特征提取和全连接网络}
	\label{fig:fullconnect}
\end{figure}

我们的地海杂波识别问题主要是基于频谱数据的特征来识别。人工识别主要基于海杂波中存在关于零频对称的布拉格峰，而地杂波只存在零频率附近的一个峰值。然而，还有一些无法直观的描述的特征，如整体幅度等等。此外，在一些频谱数据中仍然有一些无用的特征，例如，出现一个目标，这部分可以通过卷积特征提取和权重共享容易地去除对最终识别的影响。因此，本章基于CNN的方法很适合我们的问题。

通过利用CNN进行地海杂波识别，避免了对天波雷达回波的建模，从根本上避免了传统方法所面临的困难。本章根据地海杂波频谱的实际数据以及其反映出来的特性，构建了一个具有六层的基本卷积神经网络，如图\ref{fig:struct}所示，每层具有多个特征向量，每个特征向量具有多个神经元，\textcolor{red}{并且每个特征向量从提取输入的卷积滤波器的特征导出}。构建神经网络结构的其基本步骤为：

步骤1:输入地海杂波频谱数据（此处以大小为$1\times N$ 的输入序列为例），对其进行卷积运算，得到$C1$ 层。本章经过不同参数的试验对比结果，最终确定使用32个大小为$1\times 3$ 的卷积核，故特征向量中每个神经元与输入中的$1\times 3$ 的邻域相连，这样$C1$ 层中的特征大小就为$1\times (N-3)$ 。又因为$C1$ 有128个可训练参数(每个滤波器具有3个单元参数和一个偏置参数，一共32个滤波器，共$(1\times 3 + 1) = 128$ 个参数)，共$128\times(N-3)$ 个连接，将连接通过ReLU激活函数。

步骤2:对$C1$ 进行最大池化处理，该操作将相邻的多个特征采用一个特征进行代替。通过降低特征向量的长度，在减小了计算量的同时也在一定程度上修正了过拟合情形。

步骤3:将经过上述两个步骤获得的特征向量作为新的输入，重复三次步骤1至2，可以得到一个三阶段的深度卷积神经网络结构。通过上述多阶段卷积操作，输入向量的特征获得了充分的提取。

步骤4：构建输出层。压平步骤3获得的特征向量，把多维的输入一维化，以此作为卷积层到全连接层的一个过渡。在第一个全连接层的基础上添加dropout 参数，然后添加第二层全连接并通过激活函数Sigmoid ，输出识别结果。

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{figures/struct}
	\caption{卷积神经网络结构}
	\label{fig:struct}
\end{figure}

\subsubsection{池化层}
\textcolor{red}{由于我们雷达信号具有一种“静态性”属性，在一个数据区域有用的特征极有可能在另一个区域同样适用。因此，为了描述数据量较多的数据，一个很自然的想法就是对不同位置的特征进行聚合统计，例如，可以计算频谱数据上一段频率范围内的某个特征的最大值(或平均值)。这些经过采样的统计特征相比使用所有提取得到的特征不仅具有低得多的维度，同时还不容易过拟合，在一定程度上会改善结果。这种聚合的操作称为池化，常用的池化方法有平均池化和最大池化。由于这些池化单元具有平移不变性，所以即使频谱数据的布拉格峰经历了一个小的平移之后，依然会产生相同的池化的特征。
构建了本章选择频谱向量中的连续范围作为池化区域（池化长度为2），并且只是池化相同的隐藏单元产生的特征。
}

\subsubsection{训练算法}

深度神经网络训练过程在搭建好合理的深度神经网络结构之后，下一步需要利用大量的数据对该网络进行训练。对于本章数据的训练的基本流程，对于地海杂波识别问题由于需要对不同相干积累点数和多普勒频率范围的数据进行分开训练，故首先需要对不同的数据进行分类处理并标注其地海杂波类型，通过此步骤完成训练样本的生成。接下来就是利用训练样本对搭建好的网络结构进行训练，获得最终的分类器。训练过程或者说学习过程主要是利用了梯度下降算法，梯度反映了参数的移动方向。这其中一个很重要的问题就是学习率的选择，学习率过小则运行缓慢，过大则无法得到很好的结果。

传统的神经网络优化方法是mini-batch梯度下降。这个想法是计算每次迭代的mini-batch梯度，然后更新参数。然而，这种方法有两个缺点，一个是学习率的选择是困难的，因为它对所有参数使用相同的学习率，故很难选择一个很合适的初值，另一个是趋向于收敛到局部最优。

\textcolor{red}{本章不仅考虑梯度，同时考虑包含梯度变换的信息，采用了一种具有自适应学习率的优化算法Adam(Adaptive Moment Estimation)。该算法利用梯度的一阶矩估计和二阶矩估计动态地调整每个参数的学习率。经过偏置校正后，每一次迭代学习率都有明确范围，使得参数更加平稳。传统的梯度下降更新规则为$\theta \rightarrow \theta'=\theta-\eta\bigtriangledown C$ ，这里$\theta$ 表示需要学习的参数，$\eta$ 为学习速率，$\bigtriangledown C$ 为损失函数的梯度，则变为:
\begin{equation}
	v\leftarrow v'=\mu v - \eta \bigtriangledown C
\end{equation}
\begin{equation}
	\theta \leftarrow \theta' = \theta +v'
\end{equation}
在这里$\mu$ 是用来控制梯度变化的超参数。
}
训练神经网络模型。在搭建好神经网络模型后，利用训练样本对该模型做进一步训练，其基本步骤如下：
其基本的算法流程如下：

\begin{algorithm}[H]
	\caption{Adam 训练算法}
	\begin{algorithmic}[1] %每行显示行号
		\Require 训练样本$X$，样本标签$Y$，最大迭代次数$K$，步长$\varepsilon$，初始目标参数$\theta$
		\Ensure 学习后的参数$\theta$  
		\State 初始化矩估计的期望衰变率$\rho_1=0.9,\rho_2=0.999$，一阶矩与二阶矩变量$s=0,r=0$，迭代次数$k=0$ 
		\While{$k < K$}
			\State 从训练集中获取对应于目标$y^{(i)}$ 的$m$ 个采样样本 $\{x^{(1),\dots,x^{(m)}}\}$ ，其中$m$ 为批处理中一批样本的个数。
			\label{line:start}
			\State 计算梯度$g \leftarrow \frac{1}{m} \nabla_{\theta} \sum_i L(f(x^{(i)};\theta), y^{(i)}) $，其中$L$为对数损失函数，其定义为$L(P(Y|X),Y) = - \log P(Y|X) $。
			\State 更新迭代次数$k \leftarrow k+1 $
			\State 更新有偏一阶矩估计$s \leftarrow \rho_1 s + (1 - \rho_1) g $，有偏二阶矩估计$r \leftarrow \rho_2 r + (1-\rho_2) g \odot g $，其中$ g \odot g $表示对应元素的乘积。
			\State 修正一阶矩估计$\hat{s} \leftarrow \frac{s}{1-\rho^k_1} $，二阶矩估计$\hat{r} \leftarrow \frac{r}{1-\rho^k_2} $。
			\State 更新参数 $\theta \leftarrow \theta + \Delta \theta = \theta - \varepsilon \frac{\hat{s}}{\sqrt{\hat{r}} + \delta} $
			，其中$\delta = 10^{-8} $
			用来保持稳定性。
		\EndWhile
	\end{algorithmic}
\end{algorithm}

由于本章是一个二分类的问题，我们利用逻辑损失函数来训练本章的模型。
\begin{equation}
	L(z_i) = log(1+e^{-z_i})
\end{equation}
其中, $z_i=y_i(w^T x_i + b)$, $y_i$ 是采样样本 $x_i$的标签,其为1代表地杂波，0为海杂波。

\subsection{分类阈值设计}
由于我们的问题是一个二分类问题，所以我们得到的是回波频谱数据是来自于海洋还是陆地的概率。对于一般的二分类问题，我们可以使用$ 0.5 $作为概率阈值来进行分类。但是，在我们的问题上，结合实际的情况，我们需要考虑下面两个方面：
\begin{itemize}
	\item 海洋的变化远远大于陆地，海洋容易被误判为陆地。
	\item 海洋或者陆地均应该是连续的。
\end{itemize}
因此，我们不能直接输出结果。我们需要找到合适的阈值来划分地海杂波，\textcolor{red}{这将在后面讨论}。此外，我们还需要根据该距离方位单元周围单元的识别结果进行进一步处理。也就是说，如果我们得到初步结果$y_{i, j}$, $i$表示方位角的$ i $ 个单位，$ j $表示$ j $ 个斜率单位。那么，最终结果$y_{i, j}$可以表示为：
\begin{equation}
y_{i, j} = (1 - w)  y_{i, j} + \frac{w  (y_{i - 1, j} + y_{i + 1, j} + y_{i, j - 1} + y_{i, j + 1})}{4}
\end{equation}
$ w $是周围的频谱数据影响结果的权重。

\section{仿真验证}
在本节中，我们利用实际数据评估了我们提出的基于深度学习的地海杂波识别算法的性能。将我们的基于CNN的算法与基于LMS\cite{turley2013high}的根据多普勒频谱进行分类的算法和基于支持向量机进行分类的算法\cite{jin2012svm}进行了对比，我们算法相对于其余两种算法在性能上的提高，证明了我们算法的可用性。
\subsection{算法实现}
\subsubsection{基于LMS的算法}
该方法主要基于文献\cite{turley2013high}，其基本思想是利用加权最小均方算法来求解区域的模糊度，其中区域模糊度的定义如下：
\begin{equation}
	f_D = f_I + f_{cur} + f_B\left\{
		\begin{array}{rcl}
		1/2       &      & \text{前向海}\\
		0     &      & \text{陆地}\\
		-1/2       &      & \text{后向海}
		\end{array} \right.
\end{equation}
其中， $f_B$ 是前向Bragg回波与后向之差，$f_I$ 和 $f_{cur}$分别是电离层动力过程和海流产生的多普勒频偏。

% 首先介绍一种常用于工程实践中的地海杂波识别算法，单阈值法。通常，海洋和陆地杂波的差异在于，地杂波最大能量的频率几乎为零。然而，海杂波存在沿着零频率对称的有两个类似的峰，称为布拉格峰。因此，我们可以使用频率$ f $来判别频谱数据的地海杂波属性。
% \begin{equation}
% f_{i, j}= \mathop{\arg\max}_{f} \ \ x(i, j, f)
% \end{equation}
% $x(i, j, f)$ 是在频率 $f_{i, j}$下的能量值。在已知 $f_{i, j}$ 的情况下, 我们需要和阈值 $\eta$ 比较来判断其地海属性。
% \begin{equation}
% 	y_{i, j}= \left\{\begin{array}{ll}
% 		0&|f_{i, j}| > \eta, \\
% 		1&|f_{i, j}| < \eta
% 		\end{array}
% 		\right.
% \end{equation}
% 0代表海洋，1代表陆地。
\subsubsection{基于SVM的方法}
这里我们参照文献\cite{jin2012svm}，选择了如下三个特征作为分类器的特征向量：
\begin{itemize}
	\item 最大后向散射幅值
	\item 频谱中最大与次大幅值频率之差
	\item 频谱中最大与次大幅值幅度之差
\end{itemize}
同时，我们利用了网格法对参数进行了调优。

为了确保我们有足够的数据来训练和测试我们的算法，我们选取了不同的雷达工作条件、天气、时间的多组数据（每组约有20000个频谱数据）。我们随机选择其中$70\%$的数据作为训练数据，$20\%$作为交叉验证数据，其他数据用作测试数据。

\subsubsection{我们的算法}
我们根据图 \ref{fig:struct} 所示的结构搭建了本章的深度卷积神经网络分类器。对于前两个卷积层具有32个滤波器，对于第三个卷积层有64个滤波器。全连接层添加到dropout参数为0.5 。利用Adam优化算法来训练网络，初始的学习率为0.001，基本迭代次数为20次。我们使用相同的样本来分别训练和测试基于支持向量机的分类器和我们的算法。

\subsubsection{评估方法}
对于一个分类问题，最基本的算法性能评估方法是分类的准确度。然而，由于我们这里利用实际数据进行验证，这些数据没有准确的标签，尤其是地海交界处的杂波的类别更加难以确定。而在实际工程实践中，该部分的识别准确度影响着最终电离层参数的辨识。由于在实际的地图中可以得到地海交界处也即海岸线处的地理位置坐标，也即可以得到该区域的形状。因此，我们设计了与地图的匹配程度的评估方法来分析不同识别算法对于海岸线部分杂波识别的性能，其基本定义如下：
\begin{equation}
g_{C_1, C_2} = \frac{area({C_1\cap C_2})}{\max(area({C_1}), area({C_2}))}
\end{equation}
我们用0和1来二值化我们的区域，如图\ref{fig:binary}所示。$area(C)$表示区域$C$的面积, $g_{C_1, C_2}$表示区域$C_1$ 和 $C_2$ 的匹配度。
\begin{figure}
	\centering
	\includegraphics[height=0.25\textheight]{figures/binary}
	\caption{二值化地图}
	\label{fig:binary}
\end{figure}

\subsection{仿真结果分析}
% 在此基础上，我们使用相同的样本来分别训练和测试基于支持向量机的分类器和我们的算法。实验结果表明我们的算法具有更好的稳定性和准确性。
我们首先利用我们的四组数据对于三种算法进行了对比分析。实验结果如表\ref{tab:methods}所示，可以明显的看到，我们的算法的识别正确率为最优。
\begin{table}[!t]
	\renewcommand{\arraystretch}{1.3}
	\caption{三种算法的识别精度对比}
	\label{tab:methods}
	\centering
	\begin{tabular}{c|ccc}
		\hline
		数据集 & CNN & SVM & LMS \\
		\hline
		组 A  & 96.97\% & 85.69\% & 81.85\% \\
		组 B & 97.14\% & 88.57\% & 81.93\% \\
		组 C & 99.04\% & 89.03\% & 88.57\% \\
		组 D  & 99.69\% & 91.61\% & 90.33\% \\
		\hline
	\end{tabular}
\end{table}
我们选取了CNN部分识别错误的结果进行分析，如图 xxx 所示，发现该部分的数据属于特征十分不明显的内容，即使是人工判定也无法很准确的判定的结果。

地杂波被错误识别为海杂波

海杂波被错误识别为地杂波

由于数据集自身的一些限制条件，我们在组D所在的数据集进行了地图匹配度的比较实验。从表\ref{tab:method_pair}可以看出，我们的算法在匹配度方面要远高于其余两种方法，证明了我们的算法在地海边界处仍然可以保持很高的精度。
\begin{table}[H]
	\renewcommand{\arraystretch}{1.3}
	\caption{匹配度对比}
	\label{tab:method_pair}
	\centering
	\begin{tabular}{c|ccc}
		\hline
		& CNN & SVM & LMS \\
		\hline
		匹配正确率 & 0.92 & 0.23 & 0.21 \\
		\hline
	\end{tabular}
\end{table}

\textcolor{red}{
为了验证算法是否具有实时识别的能力，我们在CPU为i5-3.30GHz、运存为1GB的Linux虚拟机运行本章的算法程序，对整帧的实际雷达数据，共 xxxx 个分辨单元，每个分辨单元的相干积累点数为1024，其识别过程中占用内存峰值为178.5MB，识别时间为0.494141秒，其具备实时运行的能力。
}

\textcolor{red}{添加对于三个判断结果参数的设计}

为了验证我们的深度卷积网络在迭代次数方面的影响，其不同组数据的损失函数如图\ref{fig:group_results}所示，结果表明我们的算法可以在不同的数据集组中均可以较快的收敛。虽然，对于相同的神经网络结构，第一个数据集需要最多的迭代次数才能收敛，这是因为当频率和相干累计点的比例变小时信息或者说特征也随之减少，故需要较多的迭代次数。
\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/group_results}
	\caption{不同数据集损失函数对比图。}
	\label{fig:group_results}
\end{figure}

图\ref{fig:sizes}展示的是在样本集大小不同的情况下，我们的算法与基准算法的平均分类准确率的对比图。由于基准方法仅使用根据先验知识得到的阈值，因此随数据集增长其识别准确度变化不大，而我们的深度卷积神经网络的算法随着数据集内样本数量的增加，准确度有着显著提升。
\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/sizes}
	\caption{不同数量数据集的分类准确度对比曲线图}
	\label{fig:sizes}
\end{figure}

众所周知，卷积神经网络的参数对于最终分类识别的准确率起着重要的作用。因此，我们需要对参数的选择进行一些分析。首先，我们分析在批大小（Batch Size）和迭代次数变化时，验证集数据的分类准确度。如图\ref{fig:epoch}所示，我们可以发现识别准确度随着迭代次数的增加而增长。而当批长度变大时，收敛速度加快。
\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/epoch}
	\caption{不同批长度下，分类准确度与迭代次数曲线图}
	\label{fig:epoch}
\end{figure}

\textcolor{red}{融合预处理参数设计由于滑窗算法的很重要的一个参数就是窗长，针对于本问题主要考虑到电离层会发生变化，过长的窗长对无法及时的响应电离层的变化，影响识别准确率以及地图匹配精度。为了取得一个合适的窗长，我们首先利用不同窗长平均融合后的数据进行测试，得到图 \ref{fig:window} 的结果，该结果也证明了在窗长过长时候，准确率会下降的结论，当窗长过大时准确率会降到比窗长为1时还要低。为了进一步比较权重的变化对于识别结果的影响，我们选取公式\ref{equ:window_fusion}中的权重为$w_N=\frac{1}{2},w_k=\frac{1}{2(N-1)},k=1,2,\dots,N-1$
，得到下面结果，故根据实验结果，本章最终选择窗长长度为3。
}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/window}
	\caption{更改权重后不同窗长识别结果对比}
	\label{fig:window2}
\end{figure}

如前面所描述的，我们利用融合的方法来减少由于某一帧数据中某距离方位单元由于出现的随机噪声对于我们识别结果的影响。图\ref{fig:window}显示匹配率随着窗口长度的增加首先提高，然后减小。这是因为当窗口过长时，由于天波雷达的采样周期较长，这个期间内，雷达的频谱可能已经出现了一定程度的变化，这会影响最终的识别结果。
\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/window}
	\caption{匹配率与融合窗长对比曲线图}
	\label{fig:window}
\end{figure}
为了找出区分识别结果中海洋与陆地的最佳阈值，我们使用不同的概率阈值计算相同测试数据的正确率。图\ref{fig:threshold}显示，\textcolor{red}{随着阈值越大，增长速度越慢，速率越快}。另一方面，当阈值仅为$0.01$时，识别率仍高于$0.86$。这说明我们的方法的分类结果的概率值均处于较高的水平，如\ref{fig:prob}所示。
\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/threashold}
	\caption{识别率与概率阈值曲线图.}
	\label{fig:threshold}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/prob}
	\caption{不同帧数据识别结果概率值}
	\label{fig:prob}
\end{figure}

经过上述实验在多个不同数据集上，对我们的算法和基于支持向量机的识别算法和基于LMS的算法的对比分析，可以得到下述结论：
\begin{itemize}
	\item 我们基于卷积神经网络的方法中获得最好的结果，且在地图匹配结果方面显著优于其余两种方法。
	\item 我们的方法具有很强的鲁棒性，雷达参数或者自然变化对识别结果影响不大。
\end{itemize}

\subsection{特征可视化}
\textcolor{red}{该部分需要添加详细的内容}

上面利用大量的测试数据的识别结果以及地图匹配结果对于我们基于卷积神经网络的算法进行了验证，但是卷积神经网络方法有一个问题是其为一个黑盒操作，我们无法直观地看到其用于分类的特征。
因此，为了在理论上对于我们算法的有效性进行分析。在本节中，我们使用基于梯度变化的可视化方法，其思想为通过计算当输入数据的某个数据点发生变化时输出梯度的变化，得到每一个数据点对于输出梯度的影响，从而得到该频谱数据热力图。我们定义频谱数据序列为$ S = \{s_1, s_2, .., s_n\} $，其中$n$是频谱序列中的点数，设输出概率为$p(S)$。那么，我们可以得到式\ref{equ:ps}：
\begin{equation}
	p(S) = w^TS+b
	\label{equ:ps}
\end{equation}
其中$ w $和$ b $分别是我们的模型的权重和偏差。实际上，这里的权重$ w $表示对应点的重要性。在我们的模型中，类概率函数$p(S)$是高度非线性函数，这里使用泰勒方法近似$p(S)$。为了简化计算，我们使用一阶泰勒展开：
\begin{equation}
	w = \frac{\partial{p}}{\partial{S}}{\mid}_{s_i}
	\label{equ:w}
\end{equation}

因此，我们以通过反向传播计算得到$ w $的方程式\ref{equ:w}。图\ref{fig:vis}显示，特征点主要集中在我们预期的数据上。
\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\textwidth]{figures/othr/heatmap.pdf}
	\caption{特征重要程度热力图。}
	\label{fig:vis}
\end{figure}
% \begin{figure}[H]
% 	\centering
% 	\includegraphics[width=0.4\textwidth]{figures/othr/heatmap.pdf}
% 	\caption{某距离方位单元海杂波频谱数据关注度图。}
% 	\label{fig:visfeature1D}
% \end{figure}

% \textcolor{red}{
% 	识别结果的理论分析
% 	图\ref{fig:visfeature1D}中红色圆圈部分表示主要利用的特征所在多普勒频率，可以很直观地看出，对于下图这样的海杂波布拉格峰附近频点的数据被关注比较多，另一方面同时兼顾了其余频点的特征，提高了识别准确率。
% }
% 利用我们已经训练好的模型展示对于其最终判断测试结果为正或者为负主要利用的频谱特征点。

\section{小结}
在本章中，我们提出了基于卷积神经网络天波雷达地海杂波识别的新算法。其主要克服了传统的阈值识别方法或支持向量机算法根据经验从频谱数据中提取特征，导致操作复杂度高，分类精度低的缺点。同时，我们将我们的算法与传统算法和支持向量机算法进行了对比。实验结果表明，我们的方法在地海杂波识别问题上更加有效以及抗干扰性能更强，发现利用不同时间的同一区域的频谱数据进行融合可以很大程度上提高分类精度。。在更高精度的识别结果的帮助下，我们可以得到更加精确的修正系数，可以为目标检测和跟踪问题提供非常大的帮助。另一方面，如果我们针对于特定的问题对卷积神经网络的参数进行调整，可以进一步提高我们算法的性能。

% 综上所述，我们这里的创新点有以下两个方面：第一个是我们提出了一种使用深度卷积神经网络方法利用频谱数据进行地海杂波分类的方法，克服了传统算法的挑战；另一方面，我们利用实际数据进行验证


% \subsection{增量学习}
% 随着时间的迁移，天波超视距雷达的观测范围或者是运行参数可能会发生大的变化，使得目前的训练结果无法很好的满足新的需求，于是本文设计了一种基于增量学习的训练方法。对于新的频谱数据集一般会相比于原数据集更小，所以重新训练常常无法取得一个很好的结果，对原始训练结果进行微调是十分必须的。一般来说，DCNN的比较靠前的层所包含的特征更一般化，而更靠后的层会越来越特定于该频谱数据中包含的分类细节。所以一个比较好的方案是保持前面的一些层固定，只微调网络后面的一些层。另一方面，由于原始数据训练出的DCNN的权重是相对较好的，故需要给正在被微调的DCNN权重使用较小的学习率和学习衰减率。